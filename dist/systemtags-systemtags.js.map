{"version":3,"file":"systemtags-systemtags.js?v=c1cbe600523b4591813a","mappings":";;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;ACxTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACzMA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC7BA;AACA;AACA;;;;;ACFA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACNA;AACA;AACA;AACA;AACA;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AElDA;AACA;AACA;AACA;AACA","sources":["webpack:///nextcloud/apps/systemtags/src/app.js","webpack:///nextcloud/apps/systemtags/src/filesplugin.js","webpack:///nextcloud/apps/systemtags/src/systemtags.js","webpack:///nextcloud/apps/systemtags/src/systemtagsfilelist.js","webpack:///nextcloud/apps/systemtags/src/systemtagsinfoview.js","webpack:///nextcloud/apps/systemtags/src/css/systemtagsfilelist.scss","webpack://nextcloud/./apps/systemtags/src/css/systemtagsfilelist.scss?3cf4","webpack:///nextcloud/webpack/bootstrap","webpack:///nextcloud/webpack/runtime/amd define","webpack:///nextcloud/webpack/runtime/amd options","webpack:///nextcloud/webpack/runtime/chunk loaded","webpack:///nextcloud/webpack/runtime/compat get default export","webpack:///nextcloud/webpack/runtime/define property getters","webpack:///nextcloud/webpack/runtime/global","webpack:///nextcloud/webpack/runtime/hasOwnProperty shorthand","webpack:///nextcloud/webpack/runtime/make namespace object","webpack:///nextcloud/webpack/runtime/node module decorator","webpack:///nextcloud/webpack/runtime/jsonp chunk loading","webpack:///nextcloud/webpack/before-startup","webpack:///nextcloud/webpack/startup","webpack:///nextcloud/webpack/after-startup"],"sourcesContent":["/**\n * Copyright (c) 2015 Vincent Petry <pvince81@owncloud.com>\n *\n * @author Christoph Wurst <christoph@winzerhof-wurst.at>\n * @author Daniel Calviño Sánchez <danxuliu@gmail.com>\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n * @author Vincent Petry <vincent@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n(function () {\n  if (!OCA.SystemTags) {\n    /**\n     * @namespace\n     */\n    OCA.SystemTags = {};\n  }\n\n  OCA.SystemTags.App = {\n    initFileList($el) {\n      if (this._fileList) {\n        return this._fileList;\n      }\n\n      this._fileList = new OCA.SystemTags.FileList($el, {\n        id: 'systemtags',\n        fileActions: this._createFileActions(),\n        config: OCA.Files.App.getFilesConfig(),\n        // The file list is created when a \"show\" event is handled,\n        // so it should be marked as \"shown\" like it would have been\n        // done if handling the event with the file list already\n        // created.\n        shown: true\n      });\n      this._fileList.appName = t('systemtags', 'Tags');\n      return this._fileList;\n    },\n\n    removeFileList() {\n      if (this._fileList) {\n        this._fileList.$fileList.empty();\n      }\n    },\n\n    _createFileActions() {\n      // inherit file actions from the files app\n      const fileActions = new OCA.Files.FileActions(); // note: not merging the legacy actions because legacy apps are not\n      // compatible with the sharing overview and need to be adapted first\n\n      fileActions.registerDefaultActions();\n      fileActions.merge(OCA.Files.fileActions);\n\n      if (!this._globalActionsInitialized) {\n        // in case actions are registered later\n        this._onActionsUpdated = _.bind(this._onActionsUpdated, this);\n        OCA.Files.fileActions.on('setDefault.app-systemtags', this._onActionsUpdated);\n        OCA.Files.fileActions.on('registerAction.app-systemtags', this._onActionsUpdated);\n        this._globalActionsInitialized = true;\n      } // when the user clicks on a folder, redirect to the corresponding\n      // folder in the files app instead of opening it directly\n\n\n      fileActions.register('dir', 'Open', OC.PERMISSION_READ, '', function (filename, context) {\n        OCA.Files.App.setActiveView('files', {\n          silent: true\n        });\n        OCA.Files.App.fileList.changeDirectory(OC.joinPaths(context.$file.attr('data-path'), filename), true, true);\n      });\n      fileActions.setDefault('dir', 'Open');\n      return fileActions;\n    },\n\n    _onActionsUpdated(ev) {\n      if (!this._fileList) {\n        return;\n      }\n\n      if (ev.action) {\n        this._fileList.fileActions.registerAction(ev.action);\n      } else if (ev.defaultAction) {\n        this._fileList.fileActions.setDefault(ev.defaultAction.mime, ev.defaultAction.name);\n      }\n    },\n\n    /**\n     * Destroy the app\n     */\n    destroy() {\n      OCA.Files.fileActions.off('setDefault.app-systemtags', this._onActionsUpdated);\n      OCA.Files.fileActions.off('registerAction.app-systemtags', this._onActionsUpdated);\n      this.removeFileList();\n      this._fileList = null;\n      delete this._globalActionsInitialized;\n    }\n\n  };\n})();\n\nwindow.addEventListener('DOMContentLoaded', function () {\n  $('#app-content-systemtagsfilter').on('show', function (e) {\n    OCA.SystemTags.App.initFileList($(e.target));\n  });\n  $('#app-content-systemtagsfilter').on('hide', function () {\n    OCA.SystemTags.App.removeFileList();\n  });\n});","/**\n * Copyright (c) 2015 Vincent Petry <pvince81@owncloud.com>\n *\n * @author Joas Schilling <coding@schilljs.com>\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n * @author Vincent Petry <vincent@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n(function () {\n  OCA.SystemTags = _.extend({}, OCA.SystemTags);\n\n  if (!OCA.SystemTags) {\n    /**\n     * @namespace\n     */\n    OCA.SystemTags = {};\n  }\n  /**\n   * @namespace\n   */\n\n\n  OCA.SystemTags.FilesPlugin = {\n    ignoreLists: ['trashbin', 'files.public'],\n\n    attach(fileList) {\n      if (this.ignoreLists.indexOf(fileList.id) >= 0) {\n        return;\n      } // only create and attach once\n      // FIXME: this should likely be done on a different code path now\n      // for the sidebar to only have it registered once\n\n\n      if (!OCA.SystemTags.View) {\n        const systemTagsInfoView = new OCA.SystemTags.SystemTagsInfoView();\n        fileList.registerDetailView(systemTagsInfoView);\n        OCA.SystemTags.View = systemTagsInfoView;\n      }\n    }\n\n  };\n})();\n\nOC.Plugins.register('OCA.Files.FileList', OCA.SystemTags.FilesPlugin);","/**\n * @copyright Copyright (c) 2016 Roeland Jago Douma <roeland@famdouma.nl>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n * @author Roeland Jago Douma <roeland@famdouma.nl>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport './app';\nimport './systemtagsfilelist';\nimport './filesplugin';\nimport './systemtagsinfoview';\nimport './css/systemtagsfilelist.scss';\nwindow.OCA.SystemTags = OCA.SystemTags;","/**\n * Copyright (c) 2016 Vincent Petry <pvince81@owncloud.com>\n *\n * @author Joas Schilling <coding@schilljs.com>\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n * @author Vincent Petry <vincent@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n(function () {\n  /**\n   * @class OCA.SystemTags.FileList\n   * @augments OCA.Files.FileList\n   *\n   * @classdesc SystemTags file list.\n   * Contains a list of files filtered by system tags.\n   *\n   * @param {object} $el container element with existing markup for the #controls and a table\n   * @param {Array} [options] map of options, see other parameters\n   * @param {Array.<string>} [options.systemTagIds] array of system tag ids to\n   * filter by\n   */\n  const FileList = function ($el, options) {\n    this.initialize($el, options);\n  };\n\n  FileList.prototype = _.extend({}, OCA.Files.FileList.prototype,\n  /** @lends OCA.SystemTags.FileList.prototype */\n  {\n    id: 'systemtagsfilter',\n    appName: t('systemtags', 'Tagged files'),\n\n    /**\n     * Array of system tag ids to filter by\n     *\n     * @type Array.<string>\n     */\n    _systemTagIds: [],\n    _lastUsedTags: [],\n    _clientSideSort: true,\n    _allowSelection: false,\n    _filterField: null,\n\n    /**\n     * @private\n     * @param {object} $el container element\n     * @param {object} [options] map of options, see other parameters\n     */\n    initialize($el, options) {\n      OCA.Files.FileList.prototype.initialize.apply(this, arguments);\n\n      if (this.initialized) {\n        return;\n      }\n\n      if (options && options.systemTagIds) {\n        this._systemTagIds = options.systemTagIds;\n      }\n\n      OC.Plugins.attach('OCA.SystemTags.FileList', this);\n      const $controls = this.$el.find('#controls').empty();\n\n      _.defer(_.bind(this._getLastUsedTags, this));\n\n      this._initFilterField($controls);\n    },\n\n    destroy() {\n      this.$filterField.remove();\n      OCA.Files.FileList.prototype.destroy.apply(this, arguments);\n    },\n\n    _getLastUsedTags() {\n      const self = this;\n      $.ajax({\n        type: 'GET',\n        url: OC.generateUrl('/apps/systemtags/lastused'),\n\n        success(response) {\n          self._lastUsedTags = response;\n        }\n\n      });\n    },\n\n    _initFilterField($container) {\n      const self = this;\n      this.$filterField = $('<input type=\"hidden\" name=\"tags\"/>');\n      $container.append(this.$filterField);\n      this.$filterField.select2({\n        placeholder: t('systemtags', 'Select tags to filter by'),\n        allowClear: false,\n        multiple: true,\n        toggleSelect: true,\n        separator: ',',\n        query: _.bind(this._queryTagsAutocomplete, this),\n\n        id(tag) {\n          return tag.id;\n        },\n\n        initSelection(element, callback) {\n          const val = $(element).val().trim();\n\n          if (val) {\n            const tagIds = val.split(',');\n            const tags = [];\n            OC.SystemTags.collection.fetch({\n              success() {\n                _.each(tagIds, function (tagId) {\n                  const tag = OC.SystemTags.collection.get(tagId);\n\n                  if (!_.isUndefined(tag)) {\n                    tags.push(tag.toJSON());\n                  }\n                });\n\n                callback(tags);\n              }\n\n            });\n          } else {\n            // eslint-disable-next-line node/no-callback-literal\n            callback([]);\n          }\n        },\n\n        formatResult(tag) {\n          return OC.SystemTags.getDescriptiveTag(tag);\n        },\n\n        formatSelection(tag) {\n          return OC.SystemTags.getDescriptiveTag(tag)[0].outerHTML;\n        },\n\n        sortResults(results) {\n          results.sort(function (a, b) {\n            const aLastUsed = self._lastUsedTags.indexOf(a.id);\n\n            const bLastUsed = self._lastUsedTags.indexOf(b.id);\n\n            if (aLastUsed !== bLastUsed) {\n              if (bLastUsed === -1) {\n                return -1;\n              }\n\n              if (aLastUsed === -1) {\n                return 1;\n              }\n\n              return aLastUsed < bLastUsed ? -1 : 1;\n            } // Both not found\n\n\n            return OC.Util.naturalSortCompare(a.name, b.name);\n          });\n          return results;\n        },\n\n        escapeMarkup(m) {\n          // prevent double markup escape\n          return m;\n        },\n\n        formatNoMatches() {\n          return t('systemtags', 'No tags found');\n        }\n\n      });\n      this.$filterField.on('change', _.bind(this._onTagsChanged, this));\n      return this.$filterField;\n    },\n\n    /**\n     * Autocomplete function for dropdown results\n     *\n     * @param {object} query select2 query object\n     */\n    _queryTagsAutocomplete(query) {\n      OC.SystemTags.collection.fetch({\n        success() {\n          const results = OC.SystemTags.collection.filterByName(query.term);\n          query.callback({\n            results: _.invoke(results, 'toJSON')\n          });\n        }\n\n      });\n    },\n\n    /**\n     * Event handler for when the URL changed\n     *\n     * @param {Event} e the urlchanged event\n     */\n    _onUrlChanged(e) {\n      if (e.dir) {\n        const tags = _.filter(e.dir.split('/'), function (val) {\n          return val.trim() !== '';\n        });\n\n        this.$filterField.select2('val', tags || []);\n        this._systemTagIds = tags;\n        this.reload();\n      }\n    },\n\n    _onTagsChanged(ev) {\n      const val = $(ev.target).val().trim();\n\n      if (val !== '') {\n        this._systemTagIds = val.split(',');\n      } else {\n        this._systemTagIds = [];\n      }\n\n      this.$el.trigger($.Event('changeDirectory', {\n        dir: this._systemTagIds.join('/')\n      }));\n      this.reload();\n    },\n\n    updateEmptyContent() {\n      const dir = this.getCurrentDirectory();\n\n      if (dir === '/') {\n        // root has special permissions\n        if (!this._systemTagIds.length) {\n          // no tags selected\n          this.$el.find('#emptycontent').html('<div class=\"icon-systemtags\"></div>' + '<h2>' + t('systemtags', 'Please select tags to filter by') + '</h2>');\n        } else {\n          // tags selected but no results\n          this.$el.find('#emptycontent').html('<div class=\"icon-systemtags\"></div>' + '<h2>' + t('systemtags', 'No files found for the selected tags') + '</h2>');\n        }\n\n        this.$el.find('#emptycontent').toggleClass('hidden', !this.isEmpty);\n        this.$el.find('#filestable thead th').toggleClass('hidden', this.isEmpty);\n      } else {\n        OCA.Files.FileList.prototype.updateEmptyContent.apply(this, arguments);\n      }\n    },\n\n    getDirectoryPermissions() {\n      return OC.PERMISSION_READ | OC.PERMISSION_DELETE;\n    },\n\n    updateStorageStatistics() {// no op because it doesn't have\n      // storage info like free space / used space\n    },\n\n    reload() {\n      // there is only root\n      this._setCurrentDir('/', false);\n\n      if (!this._systemTagIds.length) {\n        // don't reload\n        this.updateEmptyContent();\n        this.setFiles([]);\n        return $.Deferred().resolve();\n      }\n\n      this._selectedFiles = {};\n\n      this._selectionSummary.clear();\n\n      if (this._currentFileModel) {\n        this._currentFileModel.off();\n      }\n\n      this._currentFileModel = null;\n      this.$el.find('.select-all').prop('checked', false);\n      this.showMask();\n      this._reloadCall = this.filesClient.getFilteredFiles({\n        systemTagIds: this._systemTagIds\n      }, {\n        properties: this._getWebdavProperties()\n      });\n\n      if (this._detailsView) {\n        // close sidebar\n        this._updateDetailsView(null);\n      }\n\n      const callBack = this.reloadCallback.bind(this);\n      return this._reloadCall.then(callBack, callBack);\n    },\n\n    reloadCallback(status, result) {\n      if (result) {\n        // prepend empty dir info because original handler\n        result.unshift({});\n      }\n\n      return OCA.Files.FileList.prototype.reloadCallback.call(this, status, result);\n    }\n\n  });\n  OCA.SystemTags.FileList = FileList;\n})();","/**\n * Copyright (c) 2015\n *\n * @author Daniel Calviño Sánchez <danxuliu@gmail.com>\n * @author Joas Schilling <coding@schilljs.com>\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n * @author Julius Härtl <jus@bitgrid.net>\n * @author Vincent Petry <vincent@nextcloud.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n(function (OCA) {\n  /**\n   * @param model\n   */\n  function modelToSelection(model) {\n    const data = model.toJSON();\n\n    if (!OC.isUserAdmin() && !data.canAssign) {\n      data.locked = true;\n    }\n\n    return data;\n  }\n  /**\n   * @class OCA.SystemTags.SystemTagsInfoView\n   * @classdesc\n   *\n   * Displays a file's system tags\n   *\n   */\n\n\n  const SystemTagsInfoView = OCA.Files.DetailFileInfoView.extend(\n  /** @lends OCA.SystemTags.SystemTagsInfoView.prototype */\n  {\n    _rendered: false,\n    className: 'systemTagsInfoView',\n    name: 'systemTags',\n\n    /* required by the new files sidebar to check if the view is unique */\n    id: 'systemTagsInfoView',\n\n    /**\n     * @type OC.SystemTags.SystemTagsInputField\n     */\n    _inputView: null,\n\n    initialize(options) {\n      const self = this;\n      options = options || {};\n      this._inputView = new OC.SystemTags.SystemTagsInputField({\n        multiple: true,\n        allowActions: true,\n        allowCreate: true,\n        isAdmin: OC.isUserAdmin(),\n\n        initSelection(element, callback) {\n          callback(self.selectedTagsCollection.map(modelToSelection));\n        }\n\n      });\n      this.selectedTagsCollection = new OC.SystemTags.SystemTagsMappingCollection([], {\n        objectType: 'files'\n      });\n\n      this._inputView.collection.on('change:name', this._onTagRenamedGlobally, this);\n\n      this._inputView.collection.on('remove', this._onTagDeletedGlobally, this);\n\n      this._inputView.on('select', this._onSelectTag, this);\n\n      this._inputView.on('deselect', this._onDeselectTag, this);\n    },\n\n    /**\n     * Event handler whenever a tag was selected\n     *\n     * @param {object} tag the tag to create\n     */\n    _onSelectTag(tag) {\n      // create a mapping entry for this tag\n      this.selectedTagsCollection.create(tag.toJSON());\n    },\n\n    /**\n     * Event handler whenever a tag gets deselected.\n     * Removes the selected tag from the mapping collection.\n     *\n     * @param {string} tagId tag id\n     */\n    _onDeselectTag(tagId) {\n      this.selectedTagsCollection.get(tagId).destroy();\n    },\n\n    /**\n     * Event handler whenever a tag was renamed globally.\n     *\n     * This will automatically adjust the tag mapping collection to\n     * container the new name.\n     *\n     * @param {OC.Backbone.Model} changedTag tag model that has changed\n     */\n    _onTagRenamedGlobally(changedTag) {\n      // also rename it in the selection, if applicable\n      const selectedTagMapping = this.selectedTagsCollection.get(changedTag.id);\n\n      if (selectedTagMapping) {\n        selectedTagMapping.set(changedTag.toJSON());\n      }\n    },\n\n    /**\n     * Event handler whenever a tag was deleted globally.\n     *\n     * This will automatically adjust the tag mapping collection to\n     * container the new name.\n     *\n     * @param {OC.Backbone.Model} tagId tag model that has changed\n     */\n    _onTagDeletedGlobally(tagId) {\n      // also rename it in the selection, if applicable\n      this.selectedTagsCollection.remove(tagId);\n    },\n\n    setFileInfo(fileInfo) {\n      const self = this;\n\n      if (!this._rendered) {\n        this.render();\n      }\n\n      if (fileInfo) {\n        this.selectedTagsCollection.setObjectId(fileInfo.id);\n        this.selectedTagsCollection.fetch({\n          success(collection) {\n            collection.fetched = true;\n            const appliedTags = collection.map(modelToSelection);\n\n            self._inputView.setData(appliedTags);\n\n            if (appliedTags.length > 0) {\n              self.show();\n            }\n          }\n\n        });\n      }\n\n      this.hide();\n    },\n\n    /**\n     * Renders this details view\n     */\n    render() {\n      this.$el.append(this._inputView.$el);\n\n      this._inputView.render();\n    },\n\n    isVisible() {\n      return !this.$el.hasClass('hidden');\n    },\n\n    show() {\n      this.$el.removeClass('hidden');\n    },\n\n    hide() {\n      this.$el.addClass('hidden');\n    },\n\n    toggle() {\n      this.$el.toggleClass('hidden');\n    },\n\n    openDropdown() {\n      this.$el.find('.systemTagsInputField').select2('open');\n    },\n\n    remove() {\n      this._inputView.remove();\n    }\n\n  });\n  OCA.SystemTags.SystemTagsInfoView = SystemTagsInfoView;\n})(OCA);","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(function(i){return i[1]});\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/*\\n * Copyright (c) 2016\\n *\\n * This file is licensed under the Affero General Public License version 3\\n * or later.\\n *\\n * See the COPYING-README file.\\n *\\n */\\n#app-content-systemtagsfilter .select2-container {\\n  width: 30%;\\n  margin-left: 10px;\\n}\\n\\n#app-sidebar .app-sidebar-header__action .tag-label {\\n  cursor: pointer;\\n  padding: 13px 0;\\n  display: flex;\\n  color: var(--color-text-light);\\n  position: relative;\\n  margin-top: -20px;\\n}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import api from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js!./systemtagsfilelist.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdD = function () {\n\tthrow new Error('define cannot be used indirect');\n};","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"systemtags-systemtags\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunknextcloud\"] = self[\"webpackChunknextcloud\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"core-common\"], () => (__webpack_require__(\"./apps/systemtags/src/systemtags.js\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":[],"sourceRoot":""}